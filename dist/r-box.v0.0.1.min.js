class RBox extends HTMLElement{_bind=null;_data=null;constructor(){super(),this._bind=this.getAttribute("data-bind"),this._data={...window[this._bind],map:{},interpolation:{}},this.parseChild(this),this.attachProxy()}parseChild=t=>{t.childNodes&&this.parseNodes(t.childNodes)};parseNodes=t=>{t.forEach(t=>{for(var e in t.dataset)this.init(t,e);this.polate(t),this.parseChild(t)})};init(t,e){const a=t.dataset[e],i={el:t,attr:e,bind:a};let n=JSON.parse(t.getAttribute("react-on")??"[]");n.push(a),n.forEach(t=>{this._data.map[t]=this._data.map[a]||[],this._data.map[t].push(i)}),t.setAttribute(e,"function"==typeof this._data[a]?this._data[a]():this._data[a]),this.attachEvents(t,e,a)}polate=e=>{if(-1<e.textContent.indexOf("${")){const a=e.textContent.replace("${","").replace("}","").replace(" ","").trim();let t=JSON.parse(e.getAttribute("react-on")??"[]");t.push(a);const i={el:e,text:()=>"function"==typeof this._data[a]?this._data[a]():""+this._data[a]};t.forEach(t=>{this._data.interpolation[t]=this._data.interpolation[a]||[],this._data.interpolation[t].push(i)}),e.innerHTML=i.text()}};attachProxy=()=>{window[this._bind]=new Proxy(this._data,{set(a,t,e){return a[t]=e,a.map[t]&&a.map[t].forEach(t=>{var e="function"==typeof a[t.bind]?a[t.bind]():a[t.bind];t.el.setAttribute(t.attr,e),"boolean"==typeof e&&(e?t.el.setAttribute(t.attr,"true"):t.el.removeAttribute(t.attr)),t.el[t.attr]&&(t.el[t.attr]=e)}),a.interpolation[t]&&a.interpolation[t].forEach(t=>{t.el.innerHTML=t.text()}),!0}})};attachEvents=(t,e,a)=>{-1!==["value","checked"].indexOf(e)&&t.addEventListener("input",t=>{window[this._bind][a]="boolean"==typeof window[this._bind][a]?t.target.checked:t.target.value})}}customElements.define("r-box",RBox);